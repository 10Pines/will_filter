<% form_tag(:action => :calendar) do %>
<%=hidden_field_tag :mf_selected_date, @date %>
<center>
	  &nbsp; 				
  	<%=link_to_function("&laquo;", "goToDate('#{@prev_month}', #{(@show_time==true)})", :style=>"font-size:16px;")%>	
	  &nbsp;&nbsp;&nbsp; 				
 		<%= select_tag("month", options_for_select(@month_options, @month), {:id => "mf_cal_month", :onChange=>"goToDate('', #{(@show_time==true)})"}) %>
 		<%= select_tag("year", options_for_select(@year_options, @year), {:id => "mf_cal_year",:onChange=>"goToDate('', #{(@show_time==true)})"}) %>
	  &nbsp;&nbsp;&nbsp; 				
  	<%=link_to_function("&raquo", "goToDate('#{@next_month}', #{(@show_time==true)})", :style=>"font-size:16px;")%>	
	  &nbsp; 				
</center>
<br>
<table class="calendar_cells">
	<tr>
		<% @days.each_with_index do |day, index| %>
			<td style="text-align:center;color:grey;font-size:10px;">
					<b><%= day %></b>
			</td>				
		<% end %>
	</tr>
	<tr>
		<% index = 0 %>
		<% while @start_date <= @end_date do %>	
			<% if @start_date.wday == 0 %>
				</tr><tr>
			<% end %>
			
			<% 0.upto(6) do |i| %>
				<td valign="top" style="width:100px;border:1px solid #ccc;">
					<% if @start_date.wday == i and @start_date <= @end_date %>
						<% today = (@start_date==Date.today) ? "today" : "" %>
						<% selected = (@start_date == @date and params[:skip_date].blank?) ? "selected" : "" %>
						<% set_date = @show_time ? "" : "setDate();" %>
						<table cellpadding="0px" cellspacing="0px" style="width:100%; background-color:white;">
							<tr>
								<td id="mf_cal_cell_<%=index%>" class="date_cell <%=today%> <%=selected%>" onClick="selectDateValue('<%=index%>', '<%=@start_date%>'); <%=set_date%>">
								 <%=@start_date.day %>
								</td>
							</tr>
						</table>
						<% @start_date = @start_date + 1.day %>
						<% index += 1 %>
					<% end %>	
				</td>
			<% end %>
		<% end %>		
	</tr>
</table>

<% if @show_time %>
<div style="text-align:center; width:100%; padding:3px;">
	Time: &nbsp; 
	<%= select_tag("mf_cal_hour", options_for_select(@hour_options, @hour)) %>
	:
	<%= select_tag("mf_cal_minute", options_for_select(@minute_options, @minute)) %>
	:
	<%= select_tag("mf_cal_second", options_for_select(@second_options, @second)) %>
</div>

<div style="text-align:center; width:100%; padding:3px;">
  <%=link_to_function("<span>Set Custom</span>", "setDateTime();", :class => "grey-button pcb") %>
  <%=link_to_function("<span>Set Now</span>", "selectDateValue(null, '#{Time.now.strftime("%Y-%m-%d %H:%M:%S")}'); setDate();", :class => "grey-button pcb") %>
  <%=link_to_function("<span>Cancel</span>", "$('mf_calendar_dialog').hide();", :class => "grey-button pcb") %>
</div>
<% else %>

<div style="text-align:center; width:100%; padding:3px;">
  <%=link_to_function("<span>Set Today</span>", "selectDateValue(null, '#{Date.today.to_s}'); setDate();", :class => "grey-button pcb") %>
  <%=link_to_function("<span>Cancel</span>", "$('mf_calendar_dialog').hide();", :class => "grey-button pcb") %>
</div>
<% end %>

<% end %>